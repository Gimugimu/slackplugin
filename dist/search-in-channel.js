!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(module,__webpack_exports__,__webpack_require__){"use strict";const PREFIX="wamei:";class Util{getUserIdFromMessage(e){for(e=e.closest(".c-virtual_list__item, ts-message");;){let t=e.find(".c-message__gutter a.c-avatar, a.message_sender").attr("href");if(t)return t.split("/")[2];if(0==(e=e.prev()).length)return null}}getMessageUriFromMessage(e){return e.closest(".c-virtual_list__item, ts-message").find("a.c-timestamp, a.timestamp").attr("href")}getTSfromUri(e){let t=e.match(/\/archives\/.+\/p(\d+)(\?thread_ts=(\d+\.\d+))?.*/);if(t[3])return t[3];if(t[1]){let e=t[1];return`${e.slice(0,e.length-6)}.${e.slice(-6)}`}return null}getUserByUserId(e){let t,n=(t=0==e.indexOf("B")?TS.model.bots:TS.model.members).filter(t=>t.id==e);return 0==n.length?null:((n=n[0]).is_bot=!(!1===n.is_bot),n.display_name=n._display_name_normalized_lc||n._real_name_normalized_lc||n.name,n.avatar_icon=n.is_bot?n.icons.image_36:n.profile.image_24,n)}getUserByName(e){let t;return 0==(t=TS.model.members.filter(t=>t._display_name_normalized_lc==e||t._real_name_normalized_lc==e)).length&&(t=TS.model.bots.filter(t=>t.name==e)),0==t.length?null:((t=t[0]).is_bot=!(!1===t.is_bot),t.display_name=t._display_name_normalized_lc||t._real_name_normalized_lc||t.name,t.avatar_icon=t.is_bot?t.icons.image_36:t.profile.image_24,t)}executeOnLoad(target,callback){const checker=()=>{let loaded=eval(target);return loaded?callback(loaded):setTimeout(checker,1)};checker()}get settings(){return{set(e,t){try{localStorage.setItem(PREFIX+e,JSON.stringify(t))}catch(e){}},get(e){try{const t=localStorage.getItem(PREFIX+e);return null==t?null:JSON.parse(t)}catch(e){return null}}}}}const util=new Util;__webpack_exports__.a=util},function(e,t,n){"use strict";n.d(t,"a",function(){return r});class r{constructor(e){this.selector=e}get $input(){return $(this.selector).find(".ql-editor")}focus(){const e=this.$input.get(0),t=document.createRange(),n=window.getSelection();t.setStartAfter(e.lastChild),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.focus()}normalize(e){return e.replace(/(<\/blockquote>)/g,"$1\n").replace(/<br>/g,"\n")}convertNewline(e){return"<p>"+e.replace(/\n/g,"</p><p>")+"</p>"}quoteText(e){return(">"+e.replace(/\n/g,"\n>").replace(/<.+?>/g,"")).replace(/>http/g,"> http")}isEmpty(){return this.$input.is(".ql-blank")}clear(){this.$input.empty()}appendText(e){this.$input.append(this.convertNewline(this.normalize(e)))}appendQuotedText(e){this.$input.append(this.convertNewline(this.quoteText(this.normalize(e))))}}},,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1);!function(){const e=new a.a(".c-search__input_box");r.a.executeOnLoad("document.querySelector('div.channel_header')",t=>{new MutationObserver(t=>{t.forEach(t=>{$(t.target).find("div.channel_title_info:not(:has(#search-in-channel))").append($('<button type="button" id="search-in-channel" class="btn_unstyle blue_on_hover channel_actions_toggle channel_header_icon ts_tip ts_tip_bottom"><span class="ts_tip_tip">チャンネル内検索</span><ts-icon class="ts_icon_search_in_channel" aria-hidden="true"></ts-icon></button>').click(()=>{$("#search_container").click(),r.a.executeOnLoad("$('.ReactModal__Content[aria-label=\"検索\"]').length",()=>{const t=TS.model.active_cid;let n="";switch(t.charAt(0)){case"C":n=`#${TS.model.channels.filter(e=>e.id==t)[0].name}`;break;case"G":n=`#${TS.model.groups.filter(e=>e.id==t)[0].name}`;break;case"D":n=`@${TS.model.ims.filter(e=>e.id==t)[0].name}`;break;default:return void e.focus()}e.clear(),e.appendText(`in:${n} `),e.$input.scrollLeft(Number.MAX_SAFE_INTEGER),e.$input.parent().click(),e.focus()})}))})}).observe(t,{childList:!0,subtree:!0})}),$("head").append("<style>.ts_icon_search_in_channel::before { content: '\\E086' }</style>")}()}]);