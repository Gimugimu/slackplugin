!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);!function(){const t=new class{constructor(){this.$input=$("#msg_input > .ql-editor")}focus(){const t=this.$input.get(0),e=document.createRange(),i=window.getSelection();e.setStartAfter(t.lastChild),e.collapse(!0),i.removeAllRanges(),i.addRange(e),t.focus()}normalizeNewline(t){return"<p>"+t.replace(/\n/g,"</p><p>")+"</p>"}quoteText(t){return"> "+t.replace(/\n/g,"\n> ").replace(/<.+?>/g,"")}isEmpty(){return this.$input.is(".ql-blank")}clear(){this.$input.empty()}appendText(t){this.$input.append(this.normalizeNewline(t))}appendQuotedText(t){this.$input.append(this.normalizeNewline(this.quoteText(t)))}},e=new class{constructor(t,e,i){this.label=t,this.iconClass=e,this.callback=i,this.selectedText="",this.userId=0,this.initElement()}initElement(){this.button=$(`<button class="c-button-unstyled c-message_actions__button ${this.label}" type="button" aria-haspopup="true" aria-label="${this.label}"><i class="c-icon ${this.iconClass}" aria-hidden="true"></i></button>`).on("mousedown",()=>{this.selectedText=window.getSelection().toString()}).click(this.callback).hover(()=>{const t=this.button.offset(),e=$(`<div class="ReactModal__Content ReactModal__Content--after-open popover" tabindex="-1" aria-label="popover" style="position: absolute; left: ${t.left}px; top: ${t.top}px; outline: none; z-index:100000;"><div><div class="c-tooltip__tip c-tooltip__tip--top" data-qa="tooltip-tip">${this.label}<div class="c-tooltip__tip__arrow"></div></div></div></div>`).hide();$(document.body).append($(`<div class="ReactModalPortal" id="${this.label}-tooltip"></div>`).append('<div class="ReactModal__Overlay ReactModal__Overlay--after-open c-popover c-popover--no-pointer c-popover--z_below_menu c-popover--fade" aria-modal="true"></div>').append(e)),e.css("left",t.left-e.width()/2+20).css("top",t.top-e.height()).fadeIn(200)},()=>{$(`#${this.label}-tooltip`).remove()})}mount(){const t=document.querySelector("div.client_main_container");return this.observer=new MutationObserver(t=>{t.forEach(t=>{const e=$(t.target).find("div.c-message_actions__container").not(`.${this.label}`).addClass(`${this.label}`);if(!e)return;e.prepend(this.button);let i=e.closest(".c-virtual_list__item");for(;;){let t=i.find(".c-message__gutter a.c-avatar").attr("href");if(t){this.userId=t.split("/")[2];break}if(0==(i=i.prev()).length)break}})}),this.observer.observe(t,{childList:!0,subtree:!0}),this}unmount(){return this.observer.disconnect(),this}}("メッセージに返信する",'c-icon--share-action" style="transform: scale(-1, 1);"',()=>{const i=e.userId,n=TS.model.members.filter(t=>t.id==i)[0],o=n._display_name_normalized_lc||n._real_name_normalized_lc;t.isEmpty()&&t.clear(),t.appendText(`<ts-mention data-id="${i}" data-label="@${o}" spellcheck="false" class="ts_tip_texty">@${o}</ts-mention> `),""!=e.selectedText&&t.appendQuotedText(`${e.selectedText}`+"\n"),t.focus()});e.mount()}()}]);